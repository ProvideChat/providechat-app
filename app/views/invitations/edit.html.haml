.col-md-12
  %h1.page-title.txt-color-blueDark
    Chat Widget
    &nbsp;/&nbsp;
    Invitations for
    = form_tag(invitations_path, method: 'get', class: 'smart-form form-inline', id: 'edit_invitations', style: 'display: inline;') do
      = select_tag "website_id", options_from_collection_for_select(@websites, "id", "url", @invitation.website_id), id: "website_id", class: "form-control select2 input-lg"

= render partial: 'layouts/flash_messages', flash: flash

- if @invitation
  .col-sm-12.col-md-12.col-lg-12
    #wid-id-0.jarviswidget.jarviswidget-color-darken
      %header
        %span.widget-icon
          %i.fa.fa-toggle-up
        %h2 Customize Invitations
      %div
        .widget-body.no-padding
          .alert.alert-info.no-margin.fade.in
            %div{style: "float: left;"}
              %i.fa-fw.fa.fa-info
            %div{style: "margin-left: 24px;"}
              When enabled, every visitor on your website will receive an invitation to chat with one of your agents after a predefined period of time or page views.
          .form-container
            .col-sm-12.col-md-5.col-lg-6
              = render 'form'
            .col-sm-12.col-md-7.col-lg-6
              = render 'invitation_widget'

:javascript
  function initialize_website_dropdown() {
    $("#website_id").select2({theme: "bootstrap"});
    
    $('#website_id').on ('change', function() {
      $('#edit_invitations').submit();
    });
  }
  
  $( document ).ready(function() {
    initialize_website_dropdown();
  });

  $(window).bind('page:change', function() {
    initialize_website_dropdown();
  });