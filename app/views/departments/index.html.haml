= render 'layouts/page_header', :title => 'Departments', :icon => 'fa-sitemap'

.row
  %article.col-sm-12.col-md-12.col-lg-8
    #website-widget.jarviswidget.jarviswidget-color-darken{:role => "widget"}
      %header{:role => "heading"}
        %span.widget-icon
          %i.fa.fa-sitemap
        %h2
          %strong Departments
        .widget-toolbar{:role => "menu"}
          = link_to "New Department", new_department_path, { title: "Add Department", class: "btn btn-primary" }
        %span.jarviswidget-loader
          %i.fa.fa-refresh.fa-spin

      %div{:role => "content"}

        .widget-body.no-padding
          .alert.alert-info.no-margin.fade.in
            %i.fa-fw.fa.fa-info
            When a visitor first begins a chat, they select from a dropdown which department they would like to chat with. This is the name of the department that is displayed to your site visitor. Also, your agents can be assigned to accept chats from only certain departments. For example, if your agent is assigned to the Sales department, she can accept chats for the Sales department only.
          %table.table.table-bordered
            %thead
              %tr
                %th Name
                %th Email
                %th
            %tbody
              - @departments.each do |department|
                %tr
                  %td= department.name
                  %td= department.email
                  %td
                    - unless current_agent.account_type == 'agent'
                      = link_to department, method: :delete, data: { confirm: 'Are you sure?' }, :class => "btn btn-danger btn-sm" do
                        %i.fa.fa-trash-o
                        Delete
                    = link_to edit_department_path(department), :class => "btn btn-default btn-sm" do
                      %i.fa.fa-edit
                      Edit

              - if @departments.count == 0
                %tr
                  %td{:colspan => "3"} No departments

